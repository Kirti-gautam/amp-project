<!DOCTYPE html>
<html amp lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="canonical" href="https://quickstart-d37705be.myshopify.com/" />
		<title>AMP Page with Custom Script</title>
		<meta
			name="amp-script-src"
			content="sha384-h3eVpVXY0w_ZxWjCk1FV1Vz8yHOiVfyOs6viQ-dP47v2TXWdeebnMWUBOX2vtmJy"
		/>
		<meta
			name="amp-script-src"
			content="sha384-OLBgp1GsljhM2TJ-sbHjaiH9txEUvgdDTAzHv2P24donTt6_529l-9Ua0vFImLlb"
		/>

		<!-- Set merchantInfo in the main window context -->
		<script>
			window.merchantInfo = {
				mid: '19g6ilkatpl78',
				environment: 'dev',
				type: 'merchantInfo',
				integrationType: 'PLUGIN',
			};
			console.log('Merchant info set in main window:', window.merchantInfo);
		</script>

		<!-- AMP Runtime -->
		<script async src="https://cdn.ampproject.org/v0.js"></script>

		<!-- AMP Script component -->
		<script
			async
			custom-element="amp-script"
			src="https://cdn.ampproject.org/v0/amp-script-0.1.js"
		></script>

		<!-- AMP Boilerplate CSS (required) -->
		<style amp-boilerplate>
			body {
				-webkit-animation: -amp-start 8s steps(1, end) 0s 1 normal both;
				-moz-animation: -amp-start 8s steps(1, end) 0s 1 normal both;
				-ms-animation: -amp-start 8s steps(1, end) 0s 1 normal both;
				animation: -amp-start 8s steps(1, end) 0s 1 normal both;
			}
			@-webkit-keyframes -amp-start {
				from {
					visibility: hidden;
				}
				to {
					visibility: visible;
				}
			}
			@-moz-keyframes -amp-start {
				from {
					visibility: hidden;
				}
				to {
					visibility: visible;
				}
			}
			@-ms-keyframes -amp-start {
				from {
					visibility: hidden;
				}
				to {
					visibility: visible;
				}
			}
			@-o-keyframes -amp-start {
				from {
					visibility: hidden;
				}
				to {
					visibility: visible;
				}
			}
			@keyframes -amp-start {
				from {
					visibility: hidden;
				}
				to {
					visibility: visible;
				}
			}
		</style>
		<noscript
			><style amp-boilerplate>
				body {
					-webkit-animation: none;
					-moz-animation: none;
					-ms-animation: none;
					animation: none;
				}
			</style></noscript
		>

		<!-- Custom styles -->
		<style amp-custom>
			/* Example of basic styling for the page */
			body {
				font-family: Arial, sans-serif;
				text-align: center;
				background-color: #f4f4f4;
			}

			h1 {
				color: #333;
			}

			p {
				color: green;
				font-size: 18px;
				margin-top: 20px;
			}
		</style>
	</head>
	<body>
		<h1>Welcome to AMP Page with Custom Script</h1>

		<!-- KwikPass SDK Integration via Public URL -->
		<amp-script layout="fixed-height" height="50" script="kwikpass-script">
			<div id="kwikpass-container" style="min-height: 50px">
				<!-- KwikPass script will run in this context -->
			</div>
		</amp-script>

		<!-- Original KwikPass script (now just initializes the container) -->
		<script id="kwikpass-script" type="text/plain" target="amp-script">
			// The merchantInfo is now set in the main window context
			console.log("KwikPass script running in amp-script context");
		</script>

		<amp-script layout="fixed-height" height="300" script="external-script">
			<div id="output">This will be updated by the script.</div>
		</amp-script>

		<script
			id="external-script"
			type="application/javascript"
			src="https://dev.pdp.gokwik.co/kwikpass/plugin/build/kp-custom-merchant.js"
			target="amp-script"
			onload="
				console.log('KwikPass SDK script loaded successfully!');
				window.dispatchEvent(new CustomEvent('kp-script-loaded'));
				const pageViewEvent = new CustomEvent('page_view_kp', { detail: { type: 'other', data: { cart_id: '' } } });
				window.dispatchEvent(pageViewEvent);
				"
		></script>
	</body>
</html>
